<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ChatGPT Clone ‚Äî –∞–¥–∞–ø—Ç–∏–≤–Ω–æ</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#0c0c0f;
  --side:#111113;
  --chat-bg:#131314;
  --input-bg:#1e1f23;
  --text:#e4e4e7;
  --text-light:#b5b5bd;
  --accent:#10a37f;
  --radius:14px;
}

body{
  margin:0;
  font-family:"Inter",sans-serif;
  background:var(--bg);
  color:var(--text);
  height:100vh;
  display:flex;
  overflow:hidden;
}

/* ===== –°–∞–π–¥–±–∞—Ä ===== */
.sidebar{
  width:260px;
  background:var(--side);
  border-right:1px solid #2c2c30;
  display:flex;
  flex-direction:column;
  padding:18px 14px;
  transition: transform 0.3s ease;
}

.new-chat{
  background:var(--input-bg);
  padding:12px 14px;
  border-radius:var(--radius);
  color:var(--text);
  border:1px solid #303035;
  cursor:pointer;
  font-size:15px;
  margin-bottom:14px;
  text-align:center;
}
.new-chat:hover{ background:#2a2b31; }

.history-title{
  margin:10px 0 6px 2px;
  font-size:13px;
  color:var(--text-light);
  text-transform:uppercase;
  font-weight:500;
}
.history-item{
  padding:10px 12px;
  border-radius:var(--radius);
  margin-bottom:6px;
  cursor:pointer;
  font-size:14px;
  color:var(--text-light);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.history-item.active{ background:#2a2b31; color:var(--text); }
.history-item:hover{ background:#2a2b31; color:var(--text); }

.sidebar-bottom{
  margin-top:auto;
  padding-top:20px;
  border-top:1px solid #2c2c30;
}
.small-btn{
  padding:10px;
  font-size:14px;
  border-radius:var(--radius);
  background:var(--input-bg);
  border:1px solid #303035;
  cursor:pointer;
  margin-bottom:8px;
  color:var(--text);
  text-align:center;
}
.small-btn:hover{ background:#2a2b31; }

/* ===== –ß–∞—Ç ===== */
.chat{
  flex:1;
  background:var(--chat-bg);
  display:flex;
  flex-direction:column;
  height:100vh;
}
.messages{
  flex:1;
  overflow-y:auto;
  padding:30px 22%;
}
.msg{
  display:flex;
  gap:16px;
  margin-bottom:28px;
  font-size:16px;
  line-height:1.55;
}
.avatar{
  width:38px;height:38px;border-radius:6px;
  background:#2d2d31;
  display:flex;align-items:center;justify-content:center;
  font-size:20px;color:#fff;
  flex-shrink:0;
}
.bubble{
  max-width:80%;
  white-space:pre-wrap;
}
.composer{
  padding:22px 22%;
  border-top:1px solid #2c2c30;
  background:var(--chat-bg);
}
.input-box{
  background:var(--input-bg);
  border:1px solid #3a3a40;
  border-radius:var(--radius);
  padding:14px 16px;
  display:flex;
  gap:12px;
  align-items:center;
}
textarea{
  flex:1;
  background:transparent;
  border:none;
  outline:none;
  color:var(--text);
  resize:none;
  font-size:16px;
  line-height:1.45;
  max-height:200px;
}
.send-btn{
  background:var(--accent);
  border:none;
  width:42px;height:42px;
  border-radius:8px;
  display:flex;align-items:center;justify-content:center;
  cursor:pointer;
  color:#fff;font-size:19px;
}
.send-btn:hover{ opacity:.8; }

/* ===== –¢–æ—á–∫–∏ "–ø–µ—á–∞—Ç–∞–µ—Ç..." ===== */
.typing span{
  width:8px;height:8px;border-radius:50%;
  background:#9797a0;
  display:inline-block;
  margin-right:4px;
  animation: blink 1.2s infinite;
}
.typing span:nth-child(2){animation-delay:.15s}
.typing span:nth-child(3){animation-delay:.3s}
@keyframes blink{
  0%,80%,100%{opacity:.3;transform:translateY(0)}
  40%{opacity:1;transform:translateY(-3px)}
}

/* ===== –ê–¥–∞–ø—Ç–∏–≤ ===== */
.menu-btn{
  display:none;
  position:fixed;
  top:14px;
  left:14px;
  z-index:1000;
  background:var(--accent);
  color:#fff;
  font-size:24px;
  width:44px;height:44px;
  border-radius:8px;
  border:none;
  cursor:pointer;
}
.overlay{
  display:none;
  position:fixed;
  top:0;left:0;
  width:100%;height:100%;
  background:rgba(0,0,0,0.5);
  z-index:900;
}

@media(max-width:768px){
  .sidebar{
    position:fixed;
    top:0;
    left:0;
    height:100%;
    transform:translateX(-100%);
    z-index:1000;
  }
  .sidebar.show{
    transform:translateX(0);
  }
  .menu-btn{ display:block; }
  .overlay.show{ display:block; }
  .chat{ padding-left:0 !important; }
}
</style>
</head>
<body>

<!-- –ö–Ω–æ–ø–∫–∞ –º–µ–Ω—é –¥–ª—è —Ç–µ–ª–µ—Ñ–æ–Ω–∞ -->
<button class="menu-btn" id="menu-btn">‚ò∞</button>
<div class="overlay" id="overlay"></div>

<div class="sidebar" id="sidebar">
  <div class="new-chat" id="btn-new">+ –ù–æ–≤—ã–π —á–∞—Ç</div>
  <div class="history-title">–ù–µ–¥–∞–≤–Ω–∏–µ</div>
  <div id="history"></div>
  <div class="sidebar-bottom">
    <div class="small-btn" id="btn-clear">–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ</div>
  </div>
</div>

<div class="chat">
  <div id="messages" class="messages"></div>
  <div class="composer">
    <div class="input-box">
      <textarea id="input" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..."></textarea>
      <button class="send-btn" id="btn-send">‚û§</button>
    </div>
  </div>
</div>

<script>
const messagesEl = document.getElementById('messages');
const inputEl = document.getElementById('input');
const btnSend = document.getElementById('btn-send');
const btnClear = document.getElementById('btn-clear');
const btnNew = document.getElementById('btn-new');
const historyEl = document.getElementById('history');
const sidebar = document.getElementById('sidebar');
const menuBtn = document.getElementById('menu-btn');
const overlay = document.getElementById('overlay');

const OPENAI_KEY = "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"; // –≤—Å—Ç–∞–≤—å —Å–≤–æ–π –∫–ª—é—á

let state = { chats: [], currentIndex: -1 };

function saveChats(){ localStorage.setItem("chat_history", JSON.stringify(state)); }
function loadChats(){
  const saved = localStorage.getItem("chat_history");
  if(saved){
    state = JSON.parse(saved);
    renderHistory();
    renderCurrentChat();
  } else { newChat(); }
}

function renderHistory(){
  historyEl.innerHTML = "";
  state.chats.forEach((c,i)=>{
    const div = document.createElement("div");
    div.className = "history-item"+(i===state.currentIndex?" active":"");
    div.textContent = c.name || "–ß–∞—Ç "+(i+1);
    div.onclick = ()=>{
      state.currentIndex=i;
      renderHistory();
      renderCurrentChat();
      saveChats();
      hideSidebar();
    };
    historyEl.appendChild(div);
  });
}

function renderCurrentChat(){
  messagesEl.innerHTML = "";
  if(state.currentIndex<0) return;
  state.chats[state.currentIndex].messages.forEach(m=>{
    const div = document.createElement('div');
    div.className='msg';
    div.innerHTML=`<div class="avatar">${m.role==='user'?'üßë':'ü§ñ'}</div><div class="bubble">${m.text}</div>`;
    messagesEl.appendChild(div);
  });
  messagesEl.scrollTop = messagesEl.scrollHeight;
}

function newChat(){
  state.chats.push({name:"–ß–∞—Ç "+(state.chats.length+1), messages:[]});
  state.currentIndex = state.chats.length-1;
  renderHistory();
  renderCurrentChat();
  saveChats();
}

function addMessage(role,text){
  if(state.currentIndex<0) newChat();
  state.chats[state.currentIndex].messages.push({role,text});
  renderCurrentChat();
  saveChats();
}

async function send(){
  const text = inputEl.value.trim();
  if(!text) return;
  addMessage('user', text);
  inputEl.value = "";

  const id = 't'+Date.now();
  messagesEl.innerHTML += `
    <div class='msg'>
      <div class='avatar'>ü§ñ</div>
      <div id='${id}' class='bubble typing'>
        <span></span><span></span><span></span>
      </div>
    </div>`;
  messagesEl.scrollTop = messagesEl.scrollHeight;

  try{
    const r = await fetch("https://api.openai.com/v1/chat/completions",{
      method:"POST",
      headers:{
        "Content-Type":"application/json",
        "Authorization":`Bearer ${OPENAI_KEY}`
      },
      body:JSON.stringify({
        model:"gpt-4o-mini",
        messages:[{role:"user",content:text}]
      })
    });
    const d = await r.json();
    const reply = d.choices[0].message.content || "–û—à–∏–±–∫–∞ API";
    document.getElementById(id).outerHTML=`<div class='bubble'>${reply}</div>`;
    addMessage('bot', reply);
  }catch{
    document.getElementById(id).outerHTML=`<div class='bubble' style='color:#f55'>–û—à–∏–±–∫–∞ API</div>`;
    addMessage('bot', '–û—à–∏–±–∫–∞ API');
  }
}

btnSend.onclick = send;
inputEl.onkeydown = e=>{ if(e.key==='Enter' && !e.shiftKey){ e.preventDefault(); send(); }};
btnClear.onclick = ()=>{ state.chats=[]; state.currentIndex=-1; renderHistory(); renderCurrentChat(); saveChats(); };
btnNew.onclick = newChat;

menuBtn.onclick = ()=>{ sidebar.classList.add('show'); overlay.classList.add('show'); };
overlay.onclick = ()=>{ hideSidebar(); };

function hideSidebar(){
  sidebar.classList.remove('show');
  overlay.classList.remove('show');
}

loadChats();
</script>
</body>
</html>
